{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://oasis-open.org/openc2/oc2led/v1.0.0",
    "title": "Blinky LED Board",
    "description": "oc2 enabled led blinky led board",
    "type": "object",
    "oneOf": [
        {
            "$ref": "#/definitions/OpenC2-Command"
        },
        {
            "$ref": "#/definitions/OpenC2-Response"
        }
    ],
    "definitions": {
        "OpenC2-Command": {
            "title": "OpenC2 Command",
            "type": "object",
            "additionalProperties": false,
            "required": [
                "action",
                "target"
            ],
            "properties": {
                "action": {
                    "$ref": "#/definitions/Action",
                    "description": "The task or activity to be performed (i.e., the \"verb\")."
                },
                "target": {
                    "$ref": "#/definitions/Target",
                    "description": "The object of the Action. The Action is performed on the Target."
                },
                "args": {
                    "$ref": "#/definitions/Args",
                    "description": "Additional information that applies to the Command."
                },
                "actuator": {
                    "$ref": "#/definitions/Actuator",
                    "description": "The subject of the Action. The Actuator executes the Action on the Target."
                },
                "command_id": {
                    "type": "string",
                    "description": "An identifier of this Command."
                }
            }
        },
        "OpenC2-Response": {
            "title": "OpenC2 Response",
            "type": "object",
            "additionalProperties": false,
            "required": [
                "status"
            ],
            "properties": {
                "status": {
                    "$ref": "#/definitions/Status-Code",
                    "description": "An integer status code"
                },
                "status_text": {
                    "type": "string",
                    "description": "A free-form human-readable description of the Response status"
                },
                "results": {
                    "$ref": "#/definitions/Results",
                    "description": "Map of key:value pairs that contain additional results based on the invoking Command."
                }
            }
        },
        "Action": {
            "title": "Action",
            "type": "string",
            "oneOf": [
                {
                    "const": "query",
                    "description": "Initiate a request for information."
                },
                {
                    "const": "set",
                    "description": "Change a value, configuration, or state of a managed entity."
                }
            ]
        },
        "Target": {
            "title": "Target",
            "type": "object",
            "description": "OpenC2 Target datatypes",
            "additionalProperties": false,
            "minProperties": 1,
            "maxProperties": 1,
            "properties": {
                "features": {
                    "$ref": "#/definitions/Features",
                    "description": "A set of items used with the query Action to determine an Actuator\"s capabilities."
                },
                "properties": {
                    "$ref": "#/definitions/Properties",
                    "description": "Data attribute associated with an Actuator."
                },
                "x-blinky:animations": {
                    "$ref": "#/definitions/Animations",
                    "description": "a set of available animations for an led board."
                },
                "x-blinky:images": {
                    "$ref": "#/definitions/Images",
                    "description": "a set of available images for an led board."
                },
                "x-blinky:leds": {
                    "$ref": "#/definitions/LEDs",
                    "description": "An led on the led board."
                },
                "x-blinky:patterns": {
                    "$ref": "#/definitions/Patterns",
                    "description": "A set of available patterns for an led board."
                },
                "x-blinky:text": {
                    "$ref": "#/definitions/LED_Text_Scroll",
                    "description": "Set text to display on the led board."
                },
                "x-blinky:sbom": {
                    "$ref": "#/definitions/SBOM",
                    "description": "get SBOM on blinky board."
                }
            }
        },
        "Args": {
            "title": "Args",
            "type": "object",
            "additionalProperties": false,
            "minProperties": 1,
            "properties": {
                "start_time": {
                    "$ref": "#/definitions/Date-Time",
                    "description": "The specific date/time to initiate the Command"
                },
                "stop_time": {
                    "$ref": "#/definitions/Date-Time",
                    "description": "The specific date/time to terminate the Command"
                },
                "duration": {
                    "$ref": "#/definitions/Duration",
                    "description": "The length of time for an Command to be in effect"
                },
                "response_requested": {
                    "$ref": "#/definitions/Response-Type",
                    "description": "The type of Response required for the Command: `none`, `ack`, `status`, `complete`."
                },
                "x-blinky": {
                    "type": "object",
                    "description": "arguments for the x-blinky targets",
                    "minProperties": 1,
                    "properties": {}
                }
            }
        },
        "Actuator": {
            "title": "Actuator",
            "type": "object",
            "additionalProperties": false,
            "minProperties": 1,
            "maxProperties": 1,
            "properties": {
                "x-blinky": {
                    "title": "Blinky LED Board",
                    "type": "object",
                    "minProperties": 1
                }
            }
        },
        "Results": {
            "title": "Results",
            "type": "object",
            "additionalProperties": false,
            "minProperties": 1,
            "properties": {
                "versions": {
                    "type": "array",
                    "description": "List of OpenC2 language versions supported by this Actuator",
                    "uniqueItems": true,
                    "minItems": 1,
                    "items": {
                        "$ref": "#/definitions/Version",
                        "description": "List of OpenC2 language versions supported by this Actuator"
                    }
                },
                "profiles": {
                    "type": "array",
                    "description": "List of profiles supported by this Actuator",
                    "items": {
                        "$ref": "#/definitions/Nsid"
                    }
                },
                "pairs": {
                    "$ref": "#/definitions/Action-Targets",
                    "description": "List of targets applicable to each supported Action"
                },
                "rate_limit": {
                    "type": "number",
                    "description": "Maximum number of requests per minute supported by design or policy"
                },
                "x-blinky": {
                    "title": "Blinky LED Board",
                    "$ref": "#/definitions/X-Blinky:Response"
                }
            }
        },
        "Action-Targets": {
            "title": "Action Targets",
            "type": "object",
            "description": "Map of each action supported by this actuator to the list of targets applicable to that action",
            "additionalProperties": false,
            "minProperties": 1,
            "properties": {
                "query": {
                    "type": "array",
                    "description": "",
                    "uniqueItems": true,
                    "minItems": 1,
                    "maxItems": 10,
                    "items": {
                        "$ref": "#/definitions/Tgt-query"
                    }
                },
                "set": {
                    "type": "array",
                    "description": "",
                    "uniqueItems": true,
                    "minItems": 1,
                    "maxItems": 10,
                    "items": {
                        "$ref": "#/definitions/Tgt-set"
                    }
                }
            }
        },
        "Tgt-query": {
            "title": "Tgt query",
            "type": "string",
            "oneOf": [
                {
                    "const": "features",
                    "description": ""
                },
                {
                    "const": "properties",
                    "description": ""
                },
                {
                    "const": "sbom",
                    "description": ""
                }
            ]
        },
        "Tgt-set": {
            "title": "Tgt set",
            "type": "string",
            "oneOf": [
                {
                    "const": "x-blinky:animations",
                    "description": ""
                },
                {
                    "const": "x-blinky:images",
                    "description": ""
                },
                {
                    "const": "x-blinky:leds",
                    "description": ""
                },
                {
                    "const": "x-blinky:patterns",
                    "description": ""
                }
            ]
        },
        "Status-Code": {
            "title": "Status Code",
            "type": "integer",
            "oneOf": [
                {
                    "const": 102,
                    "description": "Processing - an interim Response used to inform the Producer that the Consumer has accepted the Command but has not yet completed it."
                },
                {
                    "const": 200,
                    "description": "OK - the Command has succeeded."
                },
                {
                    "const": 400,
                    "description": "BadRequest - the Consumer cannot process the Command due to something that is perceived to be a Producer error (e.g., malformed Command syntax)."
                },
                {
                    "const": 401,
                    "description": "Unauthorized - the Command Message lacks valid authentication credentials for the target resource or authorization has been refused for the submitted credentials."
                },
                {
                    "const": 403,
                    "description": "Forbidden - the Consumer understood the Command but refuses to authorize it."
                },
                {
                    "const": 404,
                    "description": "NotFound - the Consumer has not found anything matching the Command."
                },
                {
                    "const": 500,
                    "description": "InternalError - the Consumer encountered an unexpected condition that prevented it from performing the Command."
                },
                {
                    "const": 501,
                    "description": "NotImplemented - the Consumer does not support the functionality required to perform the Command."
                },
                {
                    "const": 503,
                    "description": "ServiceUnavailable - the Consumer is currently unable to perform the Command due to a temporary overloading or maintenance of the Consumer."
                }
            ]
        },
        "Features": {
            "title": "Features",
            "type": "array",
            "description": "An array of zero to ten names used to query an Actuator for its supported capabilities.",
            "uniqueItems": true,
            "maxItems": 10,
            "items": {
                "$ref": "#/definitions/Feature"
            }
        },
        "Properties": {
            "title": "Properties",
            "type": "array",
            "description": "A list of names that uniquely identify properties of an Actuator.",
            "uniqueItems": true,
            "maxItems": 10,
            "items": {
                "$ref": "#/definitions/Property"
            }
        },
        "Date-Time": {
            "title": "Date Time",
            "type": "integer",
            "description": "Date and Time",
            "minimum": 0
        },
        "Duration": {
            "title": "Duration",
            "type": "integer",
            "description": "A length of time",
            "minimum": 0
        },
        "Feature": {
            "title": "Feature",
            "type": "string",
            "description": "Specifies the results to be returned from a query features Command",
            "oneOf": [
                {
                    "const": "versions",
                    "description": "List of OpenC2 Language versions supported by this Actuator"
                },
                {
                    "const": "profiles",
                    "description": "List of profiles supported by this Actuator"
                },
                {
                    "const": "pairs",
                    "description": "List of supported Actions and applicable Targets"
                },
                {
                    "const": "rate_limit",
                    "description": "Maximum number of Commands per minute supported by design or policy"
                }
            ]
        },
        "Property": {
            "title": "Property",
            "type": "string",
            "description": "Specifies the results to be returned from a query properties Command",
            "oneOf": [
                {
                    "const": "animations",
                    "description": "List of Animations supported by this Blinky Board"
                },
                {
                    "const": "images",
                    "description": "List of Images supported by this Blinky Board"
                },
                {
                    "const": "patterns",
                    "description": "List of Patterns supported by this Blinky Board"
                },
                {
                    "const": "state",
                    "description": "Current list of pixels and their associated state"
                }
            ]
        },
        "Nsid": {
            "title": "Nsid",
            "type": "string",
            "description": "A short identifier that refers to a namespace.",
            "minLength": 1,
            "maxLength": 16
        },
        "Response-Type": {
            "title": "Response Type",
            "type": "string",
            "oneOf": [
                {
                    "const": "none",
                    "description": "No response"
                },
                {
                    "const": "ack",
                    "description": "Respond when Command received"
                },
                {
                    "const": "status",
                    "description": "Respond with progress toward Command completion"
                },
                {
                    "const": "complete",
                    "description": "Respond when all aspects of Command completed"
                }
            ]
        },
        "Version": {
            "title": "Version",
            "type": "string",
            "description": "Major.Minor version number"
        },
        "Animations": {
            "title": "Animations",
            "type": "object",
            "description": "",
            "additionalProperties": false,
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "$ref": "#/definitions/LED_Animations",
                    "description": "Name of animation to show"
                },
                "repeat": {
                    "type": "integer",
                    "description": "Name of animation to show",
                    "minimum": 1
                },
                "frames_s": {
                    "type": "integer",
                    "description": "Frames per second to show",
                    "minimum": 2
                }
            }
        },
        "Images": {
            "title": "Images",
            "type": "object",
            "description": "",
            "additionalProperties": false,
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "$ref": "#/definitions/LED_Images",
                    "description": "Name of animation to show"
                }
            }
        },
        "LED-Color": {
            "title": "LEDs",
            "type": "array",
            "description": "led color",
            "items": [
                {
                    "type": "integer",
                    "description": "red value - 0-255"
                },
                {
                    "type": "integer",
                    "description": "green value - 0-255"
                },
                {
                    "type": "integer",
                    "description": "blue value - 0-255"
                }
            ]
        },
        "LEDs": {
            "title": "LEDs",
            "type": "array",
            "description": "LED configuration array",
            "items": {
                "type": "object",
                "properties": {
                    "index": {
                        "type": "integer",
                        "description": "LED index"
                    },
                    "color": {
                        "$ref": "#/definitions/LED-Color"
                    }
                }
            }
        },
        "Patterns": {
            "title": "Patterns",
            "type": "object",
            "description": "",
            "additionalProperties": false,
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "$ref": "#/definitions/LED_Patterns",
                    "description": "Name of pattern to show"
                },
                "color": {
                    "$ref": "#/definitions/LED-Color"
                },
                "wait_ms": {
                    "type": "integer",
                    "description": "Frames per second to show",
                    "minimum": 2
                },
                "repeat": {
                    "type": "integer",
                    "description": "Number of iterations of pattern",
                    "minimum": 1
                }
            }
        },
        "X-Blinky:Response": {
            "title": "X-Blinky:Response",
            "type": "object",
            "additionalProperties": false,
            "minProperties": 1,
            "properties": {
                "animations": {
                    "type": "array",
                    "unique": true,
                    "items": {
                        "$ref": "#/definitions/LED_Animations"
                    }
                },
                "images": {
                    "type": "array",
                    "unique": true,
                    "items": {
                        "$ref": "#/definitions/LED_Images"
                    }
                },
                "patterns": {
                    "type": "array",
                    "unique": true,
                    "items": {
                        "$ref": "#/definitions/LED_Patterns"
                    }
                },
                "state": {
                    "type": "array",
                    "unique": true,
                    "items": {
                        "$ref": "#/definitions/LED-Color"
                    }
                }
            }
        },
        "LED_Animations": {
            "title": "LED Animations",
            "type": "string",
            "enum": [
                "PacMan",
                "SpaceInvader"
            ]
        },
        "LED_Images": {
            "title": "LED Images",
            "type": "string",
            "enum": [
                "America",
                "Bunny",
                "G2",
                "HII",
                "Inky",
                "IronMan",
                "Mario",
                "MasterSword",
                "Oasis",
                "Smile"
            ]
        },
        "LED_Patterns": {
            "title": "LED Patterns",
            "type": "string",
            "enum": [
                "colorSpiral",
                "colorChase",
                "colorWipe",
                "diagChase",
                "diamond",
                "rainbow",
                "rainbowCycle",
                "theaterChase",
                "theaterChaseRainbow"
            ]
        },
        "LED_Text_Scroll": {
            "title": "LED Text Scroll",
            "type": "object",
            "properties": {
                "text": {
                    "type": "string",
                    "description": "Text to display on the screen"
                },
                "color": {
                    "$ref": "#/definitions/LED-Color"
                },
                "delay": {
                    "type": "number",
                    "description": "Scroll speed, larger number is slower scroll"
                }
            }
        },
        "SBOM": {
            "title": "SBOM",
            "type": "object",
            "properties": {
                "text": {
                    "type": "string",
                    "description": "Text to display on the screen"
                }
            }
        }
    }
}
